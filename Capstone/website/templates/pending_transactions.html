{% extends "base.html" %}
{% block title %}DecoOffice - Pending Transactions{% endblock %}
{% block content %}
<main class="flex-1 p-8 flex flex-col bg-[#fafaf5]">
    <!-- Header -->
    <header class="flex justify-between items-center mb-6 border-b border-gray-300 pb-4">
        <a href="{{ url_for('main.transactions') }}" class="text-gray-500 hover:text-gray-800 text-sm">
            <i class="fa-solid fa-arrow-left mr-2"></i>Go Back
        </a>
        
        <!-- --- THIS IS THE FIX --- -->
        <h2 class="text-xl font-bold text-[#3a4d39] uppercase">{{ selected_branch }} (Pending)</h2>
        
        <div class="flex items-center gap-4">
            <div class="relative">
                <input type="text" placeholder="Search..." class="w-72 pl-10 pr-4 py-2 border rounded-lg text-sm">
                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>
            {% include "_notification_button.html" %}
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex-1 flex gap-8 overflow-hidden">
        <!-- Left Panel: Table -->
        <div class="w-2/3 flex flex-col">
            <div class="grid grid-cols-5 gap-4 px-4 py-2 text-sm font-semibold text-gray-600 border-b">
                <span>Name of Issued Checked</span><span>Check No.</span><span>Check Date</span><span>EWT</span><span>Countered Check</span>
            </div>
            <div class="flex-1 overflow-y-auto custom-scrollbar pr-2 mt-2">
                <div class="space-y-2">
                    {% for t in transactions %}
                    <div class="grid grid-cols-5 gap-4 items-center px-4 py-3 text-sm bg-white rounded-lg border">
                        <span class="font-semibold">{{ t.name }}</span><span>{{ t.check_no }}</span><span>{{ t.check_date }}</span><span>{{ t.ewt }}</span><span>{{ t.countered_check }}</span>
                    </div>
                    {% else %}
                    <p class="text-center text-gray-500 pt-10">No pending transactions.</p>
                    {% endfor %}
                </div>
            </div>
            <div class="mt-auto pt-4">
                <button id="create-transaction-btn" class="px-6 py-2 bg-transparent border border-gray-400 rounded-lg hover:bg-gray-100">Create Issued Checked</button>
            </div>
        </div>

        <!-- Right Panel: Summary -->
        <div class="w-1/3 flex flex-col space-y-6 bg-white p-6 rounded-lg border">
            <div class="flex-grow flex flex-col"><label class="font-semibold text-gray-600 mb-2">Notes</label><textarea readonly class="w-full flex-grow p-3 border bg-gray-100 rounded-lg"></textarea></div>
            <div><label class="font-semibold text-gray-600 mb-2">Countered Checks</label><input type="text" readonly class="w-full px-4 py-2 bg-gray-100 border rounded-lg" value="₱ 0.00"></div>
            <div><label class="font-semibold text-gray-600 mb-2">Check Amount</label><input type="text" readonly class="w-full px-4 py-2 bg-gray-100 border rounded-lg" value="₱ 0.00"></div>
            <div class="mt-auto text-right"><button class="px-10 py-3 bg-[#3a4d39] text-white font-bold rounded-lg shadow-md">Paid</button></div>
        </div>
    </div>
</main>

{% include "_add_transaction_modal.html" %}
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('create-transaction-modal');
        const openBtn = document.getElementById('create-transaction-btn');
        const closeBtn = document.getElementById('close-create-modal-btn');
        if (modal && openBtn && closeBtn) {
            openBtn.addEventListener('click', () => modal.classList.remove('hidden'));
            closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
            modal.addEventListener('click', e => { if (e.target === modal) modal.classList.add('hidden'); });
        }
    });
</script>
{% endblock %}